/*******************  INTEL CONFIDENTIAL AND PROPRIETARY  **************************
*
*  Copyright (c) 2016 Intel Corporation.  All Rights Reserved.
*
*  This file and the information contained herein is the confidential and
*  proprietary information of Intel Corporation.  Your rights to this file and its
*  information are subject to the terms of the license agreement between
*  Intel Corporation and you or your company.
*
********************  INTEL CONFIDENTIAL AND PROPRIETARY  **************************/

function mcafee_wa_annotationevents(){this.onCompleteAnnotation=this.onAnnotatingLink=this.onPreprocessLink=this.onBeginAnnotation=this.onShowBalloon=null}
var mcafee_wa_annotationproperties={properties:{HACKERSAFE:{highlightColor:"#CCFFCC",color:"green",width:68,height:16,icon:"hackersafe.gif",background_color:"#D9EAE2",foreground_color:"#00753B"},CERTIFIED:{highlightColor:"#CCFFCC",color:"green",width:16,height:16,icon:"balloon_safe_annotation.png",background_color:"#D9EAE2",foreground_color:"#00753B"},OK:{highlightColor:"#CCFFCC",color:"green",width:16,height:16,icon:"balloon_safe_annotation.png",background_color:"#D9EAE2",foreground_color:"#00753B"},
INFO:{highlightColor:"#F7F995",color:"yellow",width:16,height:16,icon:"balloon_warning_annotation.png",background_color:"#FFF8E0",foreground_color:"#FFCC00"},WARN:{highlightColor:"#FFAAAA",color:"red",width:16,height:16,icon:"balloon_threat_annotation.png",background_color:"#F9E2E8",foreground_color:"#CC0033"},UNKNOWN:{highlightColor:"#FFFFFF",color:"white",width:18,height:18,icon:"untested.gif",background_color:"#E1E1E1",foreground_color:"#999999"}}},mcafee_wa_array=function(){return{Remove:function(b,
a){for(var c in b)if(b[c]==a)return b.splice(c,1),!0;return!1},Find:function(b,a){for(var c in b)if(!0===a(b[c]))return b[c];return null},ForEach:function(b,a,c){for(var d=0,f=b.length;d<f;++d)a(b[d],c)}}}(),mcafee_wa_balloonproperties={properties:{balloonHtmlName:"annotationballoon.html",title:"McAfee WebAdvisor",logo:"mcafee_shield.png",width:"325px",appearance:{hackersafe:{srcImage:"hs_icon.gif",borderColor:"#52b600",backgroundColor:"#52b600"},green:{srcImage:"balloon_safe_icon.png",borderColor:"#52b600",
backgroundColor:"#52b600"},yellow:{srcImage:"balloon_warning_icon.png",borderColor:"#fdae13",backgroundColor:"#fdae13"},red:{srcImage:"balloon_threat_icon.png",borderColor:"#d31245",backgroundColor:"#d31245"},white:{srcImage:"w_icon.gif",borderColor:"#B9B9B9",backgroundColor:"#B9B9B9"}}}},mcafee_wa_constants={mcafee_wa_config:"mcafee_wa_config",mcafee_wa_ann:"mcafee_wa_ann",mcafee_wa_processedtag:"mcafee_wa_processedtag",expectedcount:"mcafee_wa_expectedcount",harvestingTime:"mcafee_wa_harvestingtime",
annotationTime:"mcafee_wa_annotationtime",dssRequestTime:"mcafee_wa_requesttime",statisticsTag:"mcafee_wa_statistics",bubbleLayer:"BubbleLayer",mcafee_wa_blnimages:"sc_mcafee_wa_blnimages",mcafee_wa_configsc:"sc_mcafee_wa_configsc",mcafee_wa_pagesc:"sc_mcafee_wa_pagesc",maxCacheRecords:1E3,ScoreMinimal:15,ScoreUnknown:30,ScoreMedium:50,warningHtmlName:"wa-warning.html",annDivDefaultStyle:"margin-left: 2px; position: relative; display: inline; cursor: auto; width: 16px;  height:16px; float: none; padding:0",
annDivInline:"display: inline",annDivNonInline:"line-height:100%",scoreToColor:{OK:"green",CERTIFIED:"green",INFO:"yellow",WARN:"red",UNKNOWN:"white","":"white"},secureSearchEngineName:"yahoo"},mcafee_wa_globals=function(){var b=Date.now(),a=new Map;return{uid:b,resourceRequestor:null,dssRequestor:null,resourceRootURI:null,annotationProperties:null,balloonProperties:null,reputationReqCount:10,annotationEvents:null,activeBalloonElement:null,debugMode:!1,logger:null,activeURI:null,mapSelectors:a}}();
mcafee_wa_logtypes={None:0,Info:1,Warn:2,Err:4,Profile:8,Log:16,All:31};
var mcafee_wa_resources={IDS_PROVOCATIVEATTIRE:12035,IDS_INCIDENTALNUDITY:12077,IDS_TOBACCO:12049,IDS_ONLINESHOPPING:12034,IDS_REDIRECTURL_PHISHING:1001,IDS_HISTORICALREVISIONISM:12086,IDS_NUDITY:12031,IDS_PLUSPRODUCTNAME_W_TM:213,IDS_MEDIADOWNLOADS:12028,IDS_VERSION:170,IDS_BUILD:172,IDS_HACKINGCOMPUTERCRIME:12017,IDS_FORKIDS:12094,IDS_ENTERTAINMENTCULTURE:14102,IDS_LOCALE_DISPLAY:101,IDS_SPORTS:12044,IDS_PROFANITY:12058,IDS_PLUSEXTENSION:209,IDS_LIFESTYLE:14106,IDS_SITEDETAILS:166,IDS_MCAFEEWEBADVISORTEXT:30010,
IDS_LANGUAGE_SHORT:102,IDS_RELIGIONIDEOLOGY:12041,IDS_LASTUPDATE:173,IDS_SAFESEARCH_CashBack:20034,IDS_URL_CASHBACK_EBATES_PORTAL:1116,IDS_SAFESEARCH_moreInfoElipses:20022,IDS_TEXTTRANSLATORS:12092,IDS_ILLEGALUK:12101,IDR_MENU_TOOLBAR:103,IDS_MODERATED:12096,IDS_SPAMURLS:12069,IDS_MCAFEEWEBADVISOR:30006,IDS_ANONYMIZINGUTILITIES:12004,IDS_LANGUAGE:171,IDS_USENETNEWS:12030,IDS_PROFESSIONALNETWORKING:12090,IDS_MCAFEEWEBADVISORLIVETEXT:30011,IDS_WARNING_CAREFUL_REC:3321,IDS_RECREATIONHOBBIES:12083,IDS_SAFESEARCH_CC_Header:20029,
_APS_NEXT_SYMED_VALUE:60001,IDS_WARNING_UNSAFE_REC:3320,IDS_INTERACTIVEWEBAPPLICATIONS:12070,IDS_LOCALE_POSIX:100,IDS_REALESTATE:12082,IDS_ALCOHOL:12002,IDS_INFORMATIONCOMMUNICATION:14105,IDS_UNDOCK_YT_MSG:4E3,IDS_SOCIETYEDUCATIONRELIGION:14111,IDS_UNDOCK_YT_DONE_MSG:4001,IDS_PLUSPRODUCTNAME:212,IDS_BROWSEREXPLOITS:12098,IDS_STREAMINGMEDIA:12045,IDS_BANNER_BLOCKED:20041,IDS_CONTROVERSIALOPINIONS:12100,IDS_GENERALNEWS:12033,IDS_URL_CLIENT_UPSELL:1110,IDS_PORNOGRAPHY:12047,IDS_PUBLICINFORMATION:12007,
IDS_SAFESEARCH_okMsg:20010,IDS_ENTERTAINMENT:12011,IDS_RESIDENTIALIPADDRESSES:12105,IDS_WARNINGTEXT_UNSAFE_BLURB:3305,IDS_WARNINGTEXT_CAREFUL_BLURB:3306,ID_TOOL_MORE:113,IDS_SOCIALNETWORKING:12091,IDS_HEALTH:12018,IDS_DATINGPERSONALS:12088,IDS_HS_Recommendation:20031,IDS_INTERNETSERVICES:12075,IDS_BANNER_WARNING:20040,IDS_INFORMATIONTECHNOLOGY:14104,IDS_PHARMACY:12080,IDS_WEAPONS:12053,IDS_FINANCEBANKING:12013,IDS_BANNER_SHOWCONTENT:20042,IDS_DRUGS:12009,IDS_SEARCHENGINES:12043,IDS_EDUCATIONREFERENCE:12010,
IDS_SHAREWAREFREEWARE:12046,IDS_BLOGSWIKI:12084,IDS_ARTCULTUREHERITAGE:12001,IDS_ILLEGALSOFTWARE:12073,IDS_TECHNICALINFORMATION:12087,IDS_SEARCHBOX_EMPTYTEXT:4102,IDS_P2PFILESHARING:12036,IDS_WEBMEETINGS:12093,IDS_PERSONALPAGES:12038,IDS_MAJORGLOBALREGIONS:12102,IDS_BUSINESS:12005,IDS_SEXUALMATERIALS:12060,_APS_NEXT_COMMAND_VALUE:40001,IDS_GAMBLING:12014,IDS_GAMES:12015,ID_TOOL_SETTINGS:114,IDS_SAFESEARCH_redMsg:20033,IDS_INSTALL_DONE_MSG:10016,IDS_URL_UPGRADE_MSADP:1107,IDS_WEBPHONE:12055,IDS_DIGITALPOSTCARDS:12085,
IDS_CHROMEWARNING_MSG:3166,IDS_GAMBLINGRELATED:12064,IDS_INSTANTMESSAGING:12021,ID_TOOL_SETTINGS_SEARCH:128,IDS_SAFESEARCH_bannerWarn:20017,IDS_POLITICSOPINION:12037,IDS_INSTALL_CLOSE_BROWSER_MSG:10019,IDS_PURCHASING:14109,IDS_CONTENTSERVER:12074,IDS_COMPANYNAME:207,IDS_INSTALL_WIZARD_REBOOT_REQUIRED:2918,IDS_ANONYMIZERS:12003,_APS_NEXT_RESOURCE_VALUE:30008,IDS_PUPS:12104,IDS_JOBSEARCH:12024,IDS_INTERNETRADIOTV:12023,IDS_AUCTIONSCLASSIFIEDS:12056,IDS_RISKFRAUDCRIME:14110,IDS_INFORMATIONSECURITY:12025,
IDS_PORNOGRAPHYNUDITY:14108,IDS_HISTORY:12095,IDS_MARKETINGMERCHANDISING:12078,IDS_SAFESEARCH_cautionMsg:20009,IDS_GRUESOMECONTENT:12061,IDS_SAVE:164,IDS_CONSUMERPROTECTION:12099,IDS_SEARCHBUTTON_TOOLTIP:4101,IDS_REDIRECTURL_RESTRICTED:1E3,IDS_BUSINESSSERVICES:14100,IDS_HUMORCOMICS:12019,IDS_SCHOOLCHEATINGINFORMATION:12059,IDS_FORUMBULLETINBOARDS:12057,IDS_SEARCHBUTTON_LABEL:4100,IDS_WEBMAIL:12054,IDS_SAFESEARCH_untestedMsg:20008,IDS_VIOLENCE:12051,IDS_EXTREME:12012,IDS_VISUALSEARCHENGINE:12062,IDS_RESOURCESHARING:12042,
IDS_PARKEDDOMAIN:12079,_APS_NEXT_CONTROL_VALUE:50001,IDS_HATEDISCRIMINATION:12020,IDS_MALICIOUSSITES:12029,IDS_SPYWAREADWARE:12048,IDS_GAMESGAMBLING:14103,IDS_PERSONALNETWORKSTORAGE:12068,IDS_MOTORVEHICLES:12089,IDS_MEDIASHARING:12076,IDS_WARNING_REPUTATION_REC:3322,IDS_TRAVEL:12050,IDS_MESSAGING:12065,IDS_YAHOO_SEARCH_DISPLAYNAME:11010,IDS_SAFESEARCH_UPSELL:140,IDS_PORTALSITES:12039,IDS_BANNER_BLOCKED_TITLE:20043,IDS_TEXTSPOKENONLY:12097,IDS_GAMECARTOONVIOLENCE:12066,IDS_PHISHING:12067,IDS_SAFESEARCH_unsafeLinks:20018,
IDS_URL_HELP:1102,IDS_RESTAURANTS:12081,IDS_CHAT:12006,IDS_DRUGSGROUP:14101,IDS_MATUREVIOLENT:14107,IDS_MOBILEPHONE:12027,IDS_MCAFEEWEBADVISORLIVE:30009,IDS_SAFESEARCH_yahoo_block_text:20028,IDS_GOVERNMENTMILITARY:12016,IDS_UNINSTALL_REBOOT_MSG:3752,IDS_WEBADS:12052,IDS_DATINGSOCIALNETWORKING:12026,IDS_CRIMINALACTIVITIES:12008,IDS_PRODUCTNAME:208,IDS_MALICIOUSDOWNLOADS:12103,IDS_SOFTWAREHARDWARE:12072,IDS_TECHNICALBUSINESSFORUMS:12063,IDS_VIEWSITEREPORT:30007,IDS_REMOTEACCESS:12040,IDS_FASHIONBEAUTY:12071,
IDS_NONPROFITADVOCACYNGO:12032,IDS_STOCKTRADING:12022,IDS_WARNINGTEXT_REPUTATION_BLURB:3302};mcafee_wa_scores={Ok:0,Unknown:1,Info:2,War:3};
mcafee_wa_senginetypes={SearchEngine_UNKNOWN:0,SearchEngine_GOOGLE:1,SearchEngine_YAHOO:2,SearchEngine_MSN:3,SearchEngine_AOL:4,SearchEngine_ASK:5,SearchEngine_UOL:6,SearchEngine_GOO:7,SearchEngine_MYWAY:8,SearchEngine_BAIDU:9,SearchEngine_LIVE:10,SearchEngine_TERRA:11,SearchEngine_COMCAST:12,SearchEngine_WEB:13,SearchEngine_BIGLOBE:14,SearchEngine_SONET:15,SearchEngine_COX:16,SearchEngine_GMX:17,SearchEngine_EXCITE:18,SearchEngine_SKY:19,SearchEngine_NATE:20,SearchEngine_NAVER:21,SearchEngine_NIFTY:22,
SearchEngine_BING:23,SearchEngine_RAKUTAN:24,SearchEngine_YANDEX:25,SearchEngine_SN_LINKEDIN:26,SearchEngine_SN_GOOGLEPLUS:27,SearchEngine_SN_FACEBOOK:28,SearchEngine_WEBMAIL:100};function mcafee_wa_statistics(){this._document=null;this._scores={}}
mcafee_wa_statistics.prototype.setHiddenValue=function(b,a){var c=this._document.getElementById(mcafee_wa_constants.statisticsTag);null==c&&(c=this._document.createElement("DIV"),c.setAttribute("title",mcafee_wa_constants.statisticsTag),c.setAttribute("id",mcafee_wa_constants.statisticsTag),c=this._document.body.insertBefore(c,null));var d=this._document.getElementById(b);null==d&&(d=this._document.createElement("DIV"),d.setAttribute("id",b),d=c.appendChild(d));d.setAttribute("title",b+"-"+a)};
mcafee_wa_statistics.prototype.setDocument=function(b){if(this._document==b&&null!=this._scores)for(score in this._scores){var a=this._document.getElementById(score);null!=a&&a.setAttribute("title","0")}this._document=b;this._scores={}};mcafee_wa_statistics.prototype.setExpectedCount=function(b){this.setHiddenValue(mcafee_wa_constants.expectedcount,b)};mcafee_wa_statistics.prototype.incrementScore=function(b){b="mcafee_wa_"+b;"undefined"==typeof this._scores[b]&&(this._scores[b]=0);this._scores[b]++};
mcafee_wa_statistics.prototype.setHarvestingTime=function(b){this.setHiddenValue(mcafee_wa_constants.harvestingTime,b)};mcafee_wa_statistics.prototype.setDSSRequestTime=function(b){this.setHiddenValue(mcafee_wa_constants.dssRequestTime,b)};mcafee_wa_statistics.prototype.setAnnotationTime=function(b){this.setHiddenValue(mcafee_wa_constants.annotationTime,b)};mcafee_wa_statistics.prototype.setScores=function(){for(score in this._scores)this.setHiddenValue(score,this._scores[score])};
var mcafee_wa_categorymap=function(){return{toCategoryResId:function(b){var a=0;switch(b){case 100:a=mcafee_wa_resources.IDS_ARTCULTUREHERITAGE;break;case 101:a=mcafee_wa_resources.IDS_ALCOHOL;break;case 102:a=mcafee_wa_resources.IDS_ANONYMIZERS;break;case 104:a=mcafee_wa_resources.IDS_ANONYMIZINGUTILITIES;break;case 105:a=mcafee_wa_resources.IDS_BUSINESS;break;case 106:a=mcafee_wa_resources.IDS_CHAT;break;case 108:a=mcafee_wa_resources.IDS_PUBLICINFORMATION;break;case 109:a=mcafee_wa_resources.IDS_CRIMINALACTIVITIES;
break;case 110:a=mcafee_wa_resources.IDS_DRUGS;break;case 111:a=mcafee_wa_resources.IDS_EDUCATIONREFERENCE;break;case 112:a=mcafee_wa_resources.IDS_ENTERTAINMENT;break;case 113:a=mcafee_wa_resources.IDS_EXTREME;break;case 114:a=mcafee_wa_resources.IDS_FINANCEBANKING;break;case 115:a=mcafee_wa_resources.IDS_GAMBLING;break;case 116:a=mcafee_wa_resources.IDS_GAMES;break;case 117:a=mcafee_wa_resources.IDS_GOVERNMENTMILITARY;break;case 118:a=mcafee_wa_resources.IDS_HACKINGCOMPUTERCRIME;break;case 119:a=
mcafee_wa_resources.IDS_HEALTH;break;case 120:a=mcafee_wa_resources.IDS_HUMORCOMICS;break;case 121:a=mcafee_wa_resources.IDS_HATEDISCRIMINATION;break;case 122:a=mcafee_wa_resources.IDS_INSTANTMESSAGING;break;case 123:a=mcafee_wa_resources.IDS_STOCKTRADING;break;case 124:a=mcafee_wa_resources.IDS_INTERNETRADIOTV;break;case 125:a=mcafee_wa_resources.IDS_JOBSEARCH;break;case 126:a=mcafee_wa_resources.IDS_INFORMATIONSECURITY;break;case 127:a=mcafee_wa_resources.IDS_DATINGSOCIALNETWORKING;break;case 128:a=
mcafee_wa_resources.IDS_MOBILEPHONE;break;case 129:a=mcafee_wa_resources.IDS_MEDIADOWNLOADS;break;case 130:a=mcafee_wa_resources.IDS_MALICIOUSSITES;break;case 131:a=mcafee_wa_resources.IDS_USENETNEWS;break;case 132:a=mcafee_wa_resources.IDS_NUDITY;break;case 133:a=mcafee_wa_resources.IDS_NONPROFITADVOCACYNGO;break;case 134:a=mcafee_wa_resources.IDS_GENERALNEWS;break;case 136:a=mcafee_wa_resources.IDS_ONLINESHOPPING;break;case 137:a=mcafee_wa_resources.IDS_PROVOCATIVEATTIRE;break;case 138:a=mcafee_wa_resources.IDS_P2PFILESHARING;
break;case 139:a=mcafee_wa_resources.IDS_POLITICSOPINION;break;case 140:a=mcafee_wa_resources.IDS_PERSONALPAGES;break;case 141:a=mcafee_wa_resources.IDS_PORTALSITES;break;case 142:a=mcafee_wa_resources.IDS_REMOTEACCESS;break;case 143:a=mcafee_wa_resources.IDS_RELIGIONIDEOLOGY;break;case 144:a=mcafee_wa_resources.IDS_RESOURCESHARING;break;case 145:a=mcafee_wa_resources.IDS_SEARCHENGINES;break;case 146:a=mcafee_wa_resources.IDS_SPORTS;break;case 147:a=mcafee_wa_resources.IDS_STREAMINGMEDIA;break;case 148:a=
mcafee_wa_resources.IDS_SHAREWAREFREEWARE;break;case 149:a=mcafee_wa_resources.IDS_PORNOGRAPHY;break;case 150:a=mcafee_wa_resources.IDS_SPYWAREADWARE;break;case 151:a=mcafee_wa_resources.IDS_TOBACCO;break;case 152:a=mcafee_wa_resources.IDS_TRAVEL;break;case 153:a=mcafee_wa_resources.IDS_VIOLENCE;break;case 154:a=mcafee_wa_resources.IDS_WEBADS;break;case 155:a=mcafee_wa_resources.IDS_WEAPONS;break;case 156:a=mcafee_wa_resources.IDS_WEBMAIL;break;case 157:a=mcafee_wa_resources.IDS_WEBPHONE;break;case 158:a=
mcafee_wa_resources.IDS_AUCTIONSCLASSIFIEDS;break;case 159:a=mcafee_wa_resources.IDS_FORUMBULLETINBOARDS;break;case 160:a=mcafee_wa_resources.IDS_PROFANITY;break;case 161:a=mcafee_wa_resources.IDS_SCHOOLCHEATINGINFORMATION;break;case 162:a=mcafee_wa_resources.IDS_SEXUALMATERIALS;break;case 163:a=mcafee_wa_resources.IDS_GRUESOMECONTENT;break;case 164:a=mcafee_wa_resources.IDS_VISUALSEARCHENGINE;break;case 165:a=mcafee_wa_resources.IDS_TECHNICALBUSINESSFORUMS;break;case 166:a=mcafee_wa_resources.IDS_GAMBLINGRELATED;
break;case 167:a=mcafee_wa_resources.IDS_MESSAGING;break;case 168:a=mcafee_wa_resources.IDS_GAMECARTOONVIOLENCE;break;case 169:a=mcafee_wa_resources.IDS_PHISHING;break;case 170:a=mcafee_wa_resources.IDS_PERSONALNETWORKSTORAGE;break;case 171:a=mcafee_wa_resources.IDS_SPAMURLS;break;case 172:a=mcafee_wa_resources.IDS_INTERACTIVEWEBAPPLICATIONS;break;case 174:a=mcafee_wa_resources.IDS_FASHIONBEAUTY;break;case 175:a=mcafee_wa_resources.IDS_SOFTWAREHARDWARE;break;case 176:a=mcafee_wa_resources.IDS_ILLEGALSOFTWARE;
break;case 177:a=mcafee_wa_resources.IDS_CONTENTSERVER;break;case 178:a=mcafee_wa_resources.IDS_INTERNETSERVICES;break;case 179:a=mcafee_wa_resources.IDS_MEDIASHARING;break;case 180:a=mcafee_wa_resources.IDS_INCIDENTALNUDITY;break;case 181:a=mcafee_wa_resources.IDS_MARKETINGMERCHANDISING;break;case 183:a=mcafee_wa_resources.IDS_PARKEDDOMAIN;break;case 184:a=mcafee_wa_resources.IDS_PHARMACY;break;case 185:a=mcafee_wa_resources.IDS_RESTAURANTS;break;case 186:a=mcafee_wa_resources.IDS_REALESTATE;break;
case 187:a=mcafee_wa_resources.IDS_RECREATIONHOBBIES;break;case 188:a=mcafee_wa_resources.IDS_BLOGSWIKI;break;case 189:a=mcafee_wa_resources.IDS_DIGITALPOSTCARDS;break;case 190:a=mcafee_wa_resources.IDS_HISTORICALREVISIONISM;break;case 191:a=mcafee_wa_resources.IDS_TECHNICALINFORMATION;break;case 192:a=mcafee_wa_resources.IDS_DATINGPERSONALS;break;case 193:a=mcafee_wa_resources.IDS_MOTORVEHICLES;break;case 194:a=mcafee_wa_resources.IDS_PROFESSIONALNETWORKING;break;case 195:a=mcafee_wa_resources.IDS_SOCIALNETWORKING;
break;case 196:a=mcafee_wa_resources.IDS_TEXTTRANSLATORS;break;case 197:a=mcafee_wa_resources.IDS_WEBMEETINGS;break;case 600:a=mcafee_wa_resources.IDS_FORKIDS;break;case 601:a=mcafee_wa_resources.IDS_HISTORY;break;case 602:a=mcafee_wa_resources.IDS_MODERATED;break;case 603:a=mcafee_wa_resources.IDS_TEXTSPOKENONLY;break;case 198:a=mcafee_wa_resources.IDS_CONTROVERSIALOPINIONS;break;case 199:a=mcafee_wa_resources.IDS_RESIDENTIALIPADDRESSES;break;case 200:a=mcafee_wa_resources.IDS_BROWSEREXPLOITS;break;
case 201:a=mcafee_wa_resources.IDS_CONSUMERPROTECTION;break;case 202:a=mcafee_wa_resources.IDS_ILLEGALUK;break;case 203:a=mcafee_wa_resources.IDS_MAJORGLOBALREGIONS;break;case 204:a=mcafee_wa_resources.IDS_MALICIOUSDOWNLOADS;break;case 205:a=mcafee_wa_resources.IDS_PUPS}return a}}}();function mcafee_wa_logger(){this._logTypes=mcafee_wa_logtypes.None}mcafee_wa_logger.prototype.SetLogTypes=function(b){this._logTypes=b};
mcafee_wa_logger.prototype.log=function(b){mcafee_wa_logtypes.Log&this._logTypes&&console.log((new Date).toLocaleString()+" "+b)};mcafee_wa_logger.prototype.error=function(b){mcafee_wa_logtypes.Err&this._logTypes&&console.error((new Date).toLocaleString()+" "+b)};
var mcafee_wa_resourcemanager=function(){var b={},a={},c={},d={};return{getCSSStyleImage:function(a,b){getImageInternal(a,function(a){b("url("+a+")")})},getImage:function(b,c){try{var d=a[b];"undefined"==typeof d?mcafee_wa_globals.resourceRequestor.getImage(b,function(d){null!=d&&0<d.length?(mcafee_wa_globals.logger.log("Caching image "+b),a[b]=d,c(d)):mcafee_wa_globals.logger.error("Image "+b+" failed to fetch through resource requestor")}):c(d)}catch(g){mcafee_wa_globals.logger.error(g)}},getResString:function(a,
c){try{var d=b[a];"undefined"==typeof d||null==d?mcafee_wa_globals.resourceRequestor.getResStr(a,function(d){null!=d&&0<d.length?(mcafee_wa_globals.logger.log("Caching resource string : "+a),b[a]=d,c(d)):mcafee_wa_globals.logger.error("Resource string "+a+" failed to fetch through resource requestor")}):c(d)}catch(g){mcafee_wa_globals.logger.error(g)}},getHtml:function(a,b){var d=null;try{d=c[a],"undefined"==typeof d?mcafee_wa_globals.resourceRequestor.getHtml(a,function(d){null!=d&&0<d.length?(c[a]=
d,mcafee_wa_globals.logger.log("Caching html "+a),b(d)):mcafee_wa_globals.logger.error("Failed to retrieve html "+a)}):b(d)}catch(g){mcafee_wa_globals.logger.error(g)}},getJSON:function(a,b){var c=null;try{c=d[a],"undefined"==typeof c?mcafee_wa_globals.resourceRequestor.getJSON(a,function(c){null!=c&&0<c.length?(mcafee_wa_globals.logger.log("Caching json for "+a),d[a]=c,b(c)):mcafee_wa_globals.logger.error("Failed to fetch json "+a)}):b(c)}catch(g){mcafee_wa_globals.logger.error(g)}}}}();
function mcafee_wa_resourcerequestor(){this._messages=null}mcafee_wa_resourcerequestor.prototype.getURI=function(b){var a=null;return a=null!=mcafee_wa_globals.resourceRootURI?mcafee_wa_globals.resourceRootURI+b:chrome.extension.getURL(b)};
mcafee_wa_resourcerequestor.prototype.getImage=function(b,a){try{var c=new XMLHttpRequest,d=this.getURI("images/"+b);c.open("GET",d,!0);c.responseType="blob";c.onload=function(b){if(4==c.readyState&&200==c.status){var d=new FileReader;d.onloadend=function(){a(d.result)};d.readAsDataURL(c.response)}};c.onerror=function(a){mcafee_wa_globals.logger.error("Failed in requesting html: "+b+a)};c.send(null)}catch(f){mcafee_wa_globals.logger.error(f)}};
mcafee_wa_resourcerequestor.prototype.getContent=function(b,a,c){try{var d=new XMLHttpRequest,f=this.getURI(a+b);d.open("GET",f,!0);d.onload=function(a){4==d.readyState&&200==d.status&&c(d.responseText)};d.onerror=function(a){mcafee_wa_globals.logger.error("Failed in requesting :"+b+a)};d.send(null)}catch(h){mcafee_wa_globals.logger.error(h)}};mcafee_wa_resourcerequestor.prototype.getJSON=function(b,a){this.getContent(b,"json/",a)};
mcafee_wa_resourcerequestor.prototype.getHtml=function(b,a){this.getContent(b,"html/",a)};mcafee_wa_resourcerequestor.prototype.getResStr=function(b,a){if(null!=mcafee_wa_globals.resourceRootURI){var c=this;null==this._messages?this.getContent("messages.json","_locales/"+window.navigator.language,function(d){null!=d&&(c._messages=JSON.parse(d),null!=c._messages&&a(c._messages[b].message))}):a(c._messages[b].message)}else{var d=chrome.i18n.getMessage(b);"??"==d&&(d="");a(d)}};
var mcafee_wa_stringhelper=function(){var b=function(a,b){return a.replace(new RegExp("^["+(b||"\\s")+"]+","g"),"")},a=function(a,b){return a.replace(new RegExp("["+(b||"\\s")+"]+$","g"),"")};return{trim:function(c,d){return b(a(c,d),d)},rtrim:a,ltrim:b,mapToString:function(a){var b="{",f;for(f in a)b+='"'+f+'":"'+a[f]+'",';return b=b.replace(/,$/,"}")},truncateString:function(a,b){return null==a?"":a.length<=b?a:a.substring(0,b)+"..."},convertObjectToString:function(a){if("undefined"!=typeof JSON&&
"undefined"!=typeof JSON.stringify)try{return JSON.stringify(a)}catch(b){mcafee_wa_globals.logger.error(e)}if("object"!=typeof a)return"number"==typeof a||"boolean"==typeof a?a:"string"==typeof a?'"'+a.replace(/\"/g,"'")+'"':'""';str="{";for(attr in a)str+='"'+attr+'":'+convertObjectToString(a[attr]),str+=",";","==str.charAt(str.length-1)&&(str=str.substring(0,str.length-1));return str+="}"}}}(),mcafee_wa_timer=function(){var b=null,a=null;return{id:b,set:function(c,d,f){a=c.parentWindow?c.parentWindow:
null;b=null!=a?a.setTimeout(d,f):setTimeout(d,f)},clear:function(){try{null!=b&&(null!=a?a.clearTimeout(b):clearTimeout(b),b=null)}catch(c){mcafee_wa_globals.logger.error(c)}}}}();function mcafee_wa_ballooncreator(b){this._document=b;this._bubbleLayerElement=null}mcafee_wa_ballooncreator.prototype.isBalloonAlreadyCreated=function(){this._bubbleLayerElement=this._document.getElementById(mcafee_wa_constants.bubbleLayer+mcafee_wa_globals.uid);return null!=this._bubbleLayerElement};
mcafee_wa_ballooncreator.prototype.createBalloon=function(){try{if(this.isBalloonAlreadyCreated())return!0;mcafee_wa_globals.logger.log("Creating balloon bubble layer");var b=this;this._bubbleLayerElement=this._document.createElement("div");this._bubbleLayerElement.style.cssText="visibility:hidden;position:absolute;z-index:2147483647;";this._bubbleLayerElement.setAttribute("id",mcafee_wa_constants.bubbleLayer+mcafee_wa_globals.uid);mcafee_wa_resourcemanager.getHtml(mcafee_wa_globals.balloonProperties.properties.balloonHtmlName,
function(a){b._bubbleLayerElement.innerHTML=a;a=b._bubbleLayerElement.getElementsByTagName("*");for(var c=0;c<a.length;++c){var d=a[c],f=d.getAttribute("id");null!=f&&d.setAttribute("id",f+mcafee_wa_globals.uid)}b._document.body.insertBefore(b._bubbleLayerElement,b._document.body.childNodes[0])})}catch(a){return mcafee_wa_globals.logger.error(a),!1}return!0};
var mcafee_wa_uriFilterType={filterWithStartEnd:0},mcafee_wa_linkharvester=function(){var b=function(a,b){if("true"!=a.getAttribute("saprocessedanchor")){var d=a.getAttribute("href");!d||3>d.length||"#"==d.substr(0,1)||-1==d.indexOf(".")&&-1==d.indexOf("%2E")||b.push(a)}};return{harvestLinks:function(a,c,d){try{var f;a:{var h=[];try{var k=a.getElementsByTagName("a");mcafee_wa_array.ForEach(k,b,h);if(0==h.length){f=null;break a}}catch(r){mcafee_wa_globals.logger.error(r);f=null;break a}f=h}if(null==
f||0==f.length)return!1;h=[];k=[];if(mcafee_wa_globals.debugMode&&0==mcafee_wa_globals.mapSelectors.size)for(var g=0;g<c.selectors.length;g++)mcafee_wa_globals.mapSelectors.set(c.selectors[g].selector,0);for(var t=f.length-1;0<=t;--t){for(var p=f[t],g=0;g<c.selectors.length;++g){var q=c.selectors[g],l=!1;try{l=Sizzle.matchesSelector(p,q.selector)}catch(r){mcafee_wa_globals.logger.error(r)}if(1==l){l={};l.node=1==q.parent?p.parentNode:p;1==q.inline&&(l.node.style.display="inline-block");var x,F=a,
y=p,n=q,m=null;if("undefined"!=typeof n.hrefattr)for(var B=0;B<n.hrefattr.length;++B){var G=y.getAttribute(n.hrefattr[B]);if(null!=G){m=G.value;break}}if(null==m&&(m=y.href,"undefined"!=typeof n.hrefqstring))a:{var y=m,L=n.hrefqstring,H=F.createElement("a");H.href=y;for(var C=H.search.replace("?","").split("&"),n=0;n<C.length;++n)if(C[n]){var z=C[n].split("=");if(null!=z&&2==z.length&&z[0]==L){m=decodeURIComponent(z[1]);break a}}m=null}if(null!=m&&!m.startsWith("http")&&!m.startsWith("www.")){var u=
F.createElement("a");u.href=m;m=u.protocol+"//"+u.hostname+u.port+u.pathname+u.search+u.hash}x=m;if(null!=x){var D;a:{var I=q.excluderegex;if("undefined"!=typeof I)try{D=(new RegExp(I,"i")).test(x);break a}catch(r){mcafee_wa_globals.logger.error(r)}D=!1}if(1!=D){l.url=x.toLowerCase();null!=mcafee_wa_globals.annotationEvents.onPreprocessLink&&(l.url=mcafee_wa_globals.annotationEvents.onPreprocessLink(l.url));var g=l,A;var J=l.url,v=q.filterURI;if("undefined"!=typeof v&&v.filterType==mcafee_wa_uriFilterType.filterWithStartEnd){var w=
decodeURIComponent(unescape(J)),E=w.indexOf(v.startsWith,0);if(-1==E)A=w;else{var K=w.indexOf(v.endsWith,E);A=-1==K?w:w.slice(E+v.startsWith.length,K)}}else A=J;g.url=A;l.url=punycode.toASCII(l.url);l.node.setAttribute("original_target",l.url);mcafee_wa_globals.debugMode&&(l.matchedSelector=q.selector,mcafee_wa_globals.mapSelectors.set(q.selector,mcafee_wa_globals.mapSelectors.get(q.selector)+1));0<l.url.length&&(k.push(l),h.push(l.url));break}}}}p.setAttribute("saprocessedanchor","true");if(0<mcafee_wa_globals.reputationReqCount&&
k.length==mcafee_wa_globals.reputationReqCount){var M=h.slice(),N=k.slice();d(M,N);h=[];k=[]}}0<h.length&&d(h,k)}catch(r){mcafee_wa_globals.logger.error(r)}return!0},getRequestElements:function(){return _requestElements},getRequestURLs:function(){return _requestURLs}}}(),mcafee_wa_annotationhelper=function(){var b=function(a,b,d){return b.dossierUrl?b.dossierUrl:d.resources&&d.resources.siteReport&&d.resources.siteReport.baseURL&&a?d.resources.siteReport.baseURL+encodeURIComponent(a):null};return{getDossierURL:b,
getActualScore:function(a){if(a.actualScore)return a.actualScore;var b=a.score;isNaN(parseInt(b))||(a.score=b<mcafee_wa_constants.ScoreMinimal?"OK":b<mcafee_wa_constants.ScoreUnknown?"UNKNOWN":b<mcafee_wa_constants.ScoreMedium?"INFO":"WARN",b=a.score);!a.hackerSafe||"OK"!=a.score&&"CERTIFIED"!=a.score||(b="HACKERSAFE",isHackerSafe=!0);return b},getLinkConfig:function(a){var b=a.linkConfig?a.linkConfig:{};a=mcafee_wa_globals.annotationProperties.properties[a.actualScore];"string"!=typeof b.icon&&(b.icon=
a.icon);"string"!=typeof b.highlightColor&&(b.highlightColor=a.highlightColor);"string"!=typeof b.color&&(b.color=a.color);"number"!=typeof b.iconWidth&&(b.iconWidth=a.width);"number"!=typeof b.iconHeight&&(b.iconHeight=a.height);"boolean"!=typeof b.disableLink&&(b.disableLink=!1);return b},populateLinkInfo:function(a,c,d,f){a.actualScore=f;"undefined"==typeof a.colour&&"undefined"==typeof a.score?f=void 0:(f=a.colour?a.colour:mcafee_wa_constants.scoreToColor[a.score],"green"==f&&a.hackerSafe&&(f=
"hackersafe"));a.colour=f;a.recommendation=a.recommendation?a.recommendation:"";a.dossierUrl=b(c,a,d);a.domain_specifier=a.domain_specifier?a.domain_specifier:"";a.CCList=a.CCList?a.CCList:"{}";a.displayURL=mcafee_wa_stringhelper.truncateString(c,50)}}}(),mcafee_wa_searchengine=function(){var b=null;return{init:function(a){null==b&&mcafee_wa_resourcemanager.getJSON("engines.json",function(c){try{b=JSON.parse(c),null!=a?a():mcafee_wa_globals.logger.error("Failed to parse engines.json")}catch(d){mcafee_wa_globals.logger.error(d)}})},
getEngineForUrl:function(a){return mcafee_wa_array.Find(b.searchengines,function(b){for(var d=0;d<b.urlre.length;++d)try{var f=(new RegExp(b.urlre[d],"i")).test(a);if(1==f)return f}catch(h){mcafee_wa_globals.logger.error(h)}return!1})},getEngines:function(){return b.searchengines},disableEngine:function(a){a=a.toLowerCase();for(var c in b.searchengines.length){var d=b.searchengines[c];if(d.name==a)return d.enabled=!1,!0}return!1},getEngineByName:function(a){return mcafee_wa_array.Find(b.searchengines,
function(b){return b.name==a?!0:!1})}}}(),recElemStyle={Small:0,Normal:1},recElemLength={maxLength:30,maxHackerSafeLength:15};
function mcafee_wa_balloondisplayer(){this._recommendationDesc=this._dossierElement=this._balloonColorElement=this._borderElement=this._iconElement=this._categoryTitleElement=this._balloonElement=this._titleElement=this._recommendationElement=this._logoElement=this._bubbleLayerElement=null;this._categoryElements=[];this._isCurrentHackerSafe=!1;this._recommendationDefStyle=[]}mcafee_wa_balloondisplayer.prototype.initElement=function(b){return this._document.getElementById(b+this._uid)};
mcafee_wa_balloondisplayer.prototype.preProcessRecommendationId=function(b,a){if(20034==b)switch(a){case "HACKERSAFE":case "CERTIFIED":b=20031;break;case "OK":b=20010;break;case "INFO":b=20009;break;case "WARN":b=20033;break;case "UNKNOWN":b=20008}return b};mcafee_wa_balloondisplayer.prototype.getRecommendationString=function(b,a){if(b.recommendation){var c=parseInt(b.recommendation);isNaN(c)||(c="res_"+this.preProcessRecommendationId(c,b.actualScore),mcafee_wa_resourcemanager.getResString(c,a))}};
mcafee_wa_balloondisplayer.prototype.addRecommendationElemStyle=function(b,a,c,d,f,h){b.padding=new String(a);b.fontSize=new String(c);b.fontWeight=new String(d);b.clear=new String(f);b.lineHeight=new String(h)};
mcafee_wa_balloondisplayer.prototype.init=function(b){try{if(mcafee_wa_globals.logger.log(b?"Showing balloon":"Hiding balloon"),this._bubbleLayerElement=this.initElement("BubbleLayer"),1==b){this._logoElement=this.initElement("BALLOONLOGO");this._recommendationElement=this.initElement("RECOMMENDATION");this._titleElement=this.initElement("WEBADVISORTEXT");this._balloonElement=this.initElement("BALLOON");this._categoryTitleElement=this.initElement("CCHeader");this._iconElement=this.initElement("ICON");
this._borderElement=this.initElement("BALLOON_BORDER");this._balloonColorElement=this.initElement("BALLOON_CLR");this._dossierElement=this.initElement("DOSSIER_LINK");this._recommendationDesc=this.initElement("RECOMMENDATIONDESC");this._categoryElements=[];for(b=0;3>b;++b){var a=this.initElement("CC_DESC_"+b);this._categoryElements.push(a)}if(0==this._recommendationDefStyle.length){var c=this._recommendationDefStyle,d=this._recommendationElement;c.push({});c.push({});this.addRecommendationElemStyle(c[recElemStyle.Small],
"16px 16px 0px 20px","12px","600",null,null);this.addRecommendationElemStyle(c[recElemStyle.Normal],d.style.padding,d.style.fontSize,d.style.fontWeight,d.style.clear,d.style.lineHeight)}}}catch(f){return mcafee_wa_globals.logger.error(f),!1}return!0};
mcafee_wa_balloondisplayer.prototype.setCategories=function(b,a){for(var c=this,d=0,f=0;3>f&&!(this._categoryElements.length<=f);++f)if(null!=this._categoryElements[d]&&(this._categoryElements[f].innerHTML="",this._categoryElements[f].style.lineHeight="0px",this._categoryElements[f].style.display="none",this._categoryElements[f].parentNode.style.display="none",this._categoryElements[f].parentNode.style.lineHeight="0px",b.categories.length>f)){var h=parseInt(b.categories[f]);isNaN(h)||(h=mcafee_wa_categorymap.toCategoryResId(h),
mcafee_wa_resourcemanager.getResString("res_"+h,function(a){"undefined"!=typeof a&&0<a.length&&(c._categoryElements[d].innerHTML=a,c._categoryElements[d].style.display="block",c._categoryElements[d].parentNode.style.display="",c._categoryElements[d].style.lineHeight="20px",++d)}))}};
mcafee_wa_balloondisplayer.prototype.resizeRecommendationElement=function(b){this._recommendationElement.style.padding=this._recommendationDefStyle[b].padding;this._recommendationElement.style.fontSize=this._recommendationDefStyle[b].fontSize;this._recommendationElement.style.fontWeight=this._recommendationDefStyle[b].fontWeight;this._recommendationElement.style.clear=this._recommendationDefStyle[b].clear;this._recommendationElement.style.lineHeight=this._recommendationDefStyle[b].lineHeight};
mcafee_wa_balloondisplayer.prototype.showBalloon=function(b,a,c,d,f){this._document=b;this._uid=a;if(this.init(!0)){var h=this._document.all?f.srcElement:f.target;if(null!=h){b=h.parentNode.getAttribute(mcafee_wa_constants.mcafee_wa_ann);var k=JSON.parse(b);if(null!=b&&null!=k&&(b=mcafee_wa_globals.balloonProperties.properties.appearance[k.colour],"undefined"!=typeof b)){null!=this._titleElement&&(this._titleElement.innerHTML=mcafee_wa_globals.debugMode?k.matchedSelector:mcafee_wa_globals.balloonProperties.properties.title);
var g=this;null!=this._iconElement&&mcafee_wa_resourcemanager.getImage(b.srcImage,function(a){g._iconElement.innerHTML="<img alt='' src='"+a+"' style='vertical-align:middle;max-width:none' />"});null!=this._borderElement&&(this._borderElement.style.borderColor=b.borderColor);null!=this._balloonColorElement&&(this._balloonColorElement.style.backgroundColor=b.backgroundColor);null!=this._logoElement&&mcafee_wa_resourcemanager.getImage(mcafee_wa_globals.balloonProperties.properties.logo,function(a){g._logoElement.innerHTML=
"<img alt='' src='"+a+"' />"});this._isCurrentHackerSafe=k.hackerSafe;null!=this._recommendationElement&&this.getRecommendationString(k,function(a){a.length>recElemLength.maxLength||g._isCurrentHackerSafe&&a.length>recElemLength.maxHackerSafeLength?g.resizeRecommendationElement(recElemStyle.Small):g.resizeRecommendationElement(recElemStyle.Normal);g._recommendationElement.innerHTML=a;mcafee_wa_globals.debugMode&&(g._recommendationDesc.innerHTML="",mcafee_wa_globals.mapSelectors.forEach(function(a,
b,c){g._recommendationDesc.innerHTML=g._recommendationDesc.innerHTML+b+"\t:\t"+a+" times(s)</br>"}))});null!=this._bubbleLayerElement&&(this._bubbleLayerElement.onmouseout=function(a){g.hideBalloon(g._document,mcafee_wa_globals.uid,a)});null!=this._borderElement&&(this._borderElement.style.width=mcafee_wa_globals.balloonProperties.properties.width);null!=this._balloonElement&&(this._balloonElement.style.width=mcafee_wa_globals.balloonProperties.properties.width);this.setCategories(k,c);null!=this._dossierElement&&
(mcafee_wa_resourcemanager.getResString("res_"+mcafee_wa_resources.ID_TOOL_MORE,function(a){g._dossierElement.innerHTML="white"==k.colour?"":a}),this._dossierElement.href=k.dossierUrl+"&ref=safesearch");if(null!=mcafee_wa_globals.annotationEvents.onShowBalloon)mcafee_wa_globals.annotationEvents.onShowBalloon(k,this._document,mcafee_wa_globals.uid);this.moveBubble(f);"undefined"!=typeof d.autoclose&&0<d.autoclose&&(mcafee_wa_globals._activeBalloonElement=h,g=this,setTimeout(function(){mcafee_wa_globals._activeBalloonElement==
h&&(g._bubbleLayerElement.style.visibility="hidden")},d.autoclose))}}}};
mcafee_wa_balloondisplayer.prototype.getBalloonPosition=function(b){var a=b.getBoundingClientRect(),c=this._document.body,d=this._document.documentElement;b=window.pageYOffset||d.scrollTop||c.scrollTop;var f=window.pageXOffset||d.scrollLeft||c.scrollLeft,h=a.top+b-(d.clientTop||c.clientTop||0),a=a.right+f-(d.clientLeft||c.clientLeft||0),c=this._bubbleLayerElement.getBoundingClientRect();if(c.height>window.innerHeight||c.width>window.innerWidth)return{top:-1,left:-1};h+c.height+15>window.innerHeight+
b&&(h=h-(c.height-(window.innerHeight+b-h))-15);a+c.width+15>window.innerWidth+f&&(a=a-(c.width-(window.innerWidth+f-a))-15);return{top:Math.round(h),left:Math.round(a)}};
mcafee_wa_balloondisplayer.prototype.moveBubble=function(b){b=this.getBalloonPosition(b.toElement||b.currentTarget);-1==b.top||-1==b.left?(mcafee_wa_globals.logger.log("Hiding balloon since there is no space to show it"),this._bubbleLayerElement.style.visibility="hidden"):(mcafee_wa_globals.logger.log("Showing balloon at "+b.top+" , "+b.left),this._bubbleLayerElement.style.top=b.top+"px",this._bubbleLayerElement.style.left=b.left+"px",this._bubbleLayerElement.style.visibility="visible")};
mcafee_wa_balloondisplayer.prototype.hideBalloon=function(b,a,c){this._document=b;this._uid=a;this.init(!1)&&(b=c.toElement||c.relatedTarget)&&!this._bubbleLayerElement.contains(b)&&(this._bubbleLayerElement.style.visibility="hidden")};
function mcafee_wa_coreproperties(){this.logger=null;this.logType=mcafee_wa_logtypes.None;this.resourceRootURI=this.resourceRequestor=this.dssRequestor=null;this.reputationReqCount=10;this.annotationProperties=this.balloonProperties=null;this.events=new mcafee_wa_annotationevents;this.debugMode=!1}var mcafee_wa_eventhandler=function(b,a,c){this._document=b;this._config=a;this._engine=c;this._displayer=new mcafee_wa_balloondisplayer};
mcafee_wa_eventhandler.prototype.registerEvents=function(b){b.addEventListener("mouseover",this);b.addEventListener("mouseout",this)};mcafee_wa_eventhandler.prototype.handleEvent=function(b){try{switch(b.type){case "mouseover":this._displayer.showBalloon(this._document,mcafee_wa_globals.uid,this._config,this._engine,b);break;case "mouseout":this._displayer.hideBalloon(this._document,mcafee_wa_globals.uid,b)}}catch(a){mcafee_wa_globals.logger.error(a)}};
function mcafee_wa_annotationinserter(){this._document=null}mcafee_wa_annotationinserter.prototype.setDivProperty=function(b,a){var c=mcafee_wa_stringhelper.convertObjectToString(a);b.setAttribute(mcafee_wa_constants.mcafee_wa_ann,c)};
mcafee_wa_annotationinserter.prototype.createStyle=function(){var b=this._document.getElementById("mc_style");if(null==b){mcafee_wa_globals.logger.log("Adding annotation images under global style tag");b=this._document.createElement("style");b.setAttribute("id","mc_style");b.type="text/css";this._document.getElementsByTagName("head")[0].appendChild(b);for(var a in mcafee_wa_globals.annotationProperties.properties)(function(a){var d=mcafee_wa_globals.annotationProperties.properties[a];mcafee_wa_resourcemanager.getImage(d.icon,
function(f){try{""!=b.innerHTML&&(b.innerHTML+="\n"),b.innerHTML+=".mcafee_"+a+"{background-image: url("+f+");",b.innerHTML+=" height:"+d.height+"px; width:"+d.width+"px ; display:inline-block }"}catch(h){mcafee_wa_globals.logger.error(h)}})})(a)}};
mcafee_wa_annotationinserter.prototype.insertAnnotationImage=function(b,a,c,d){try{var f=this._document.createElement("div"),h=mcafee_wa_annotationhelper.getLinkConfig(a);mcafee_wa_annotationhelper.getDossierURL(b.url,a,c);var k=this._document.createElement("div");f.appendChild(k);k.setAttribute("class","mcafee_"+a.actualScore);d.registerEvents(k);this.setDivProperty(f,a);c.features.highlite&&this.highlightLink(b,h.highlightColor);h.filterLink&&(h.disableLink=h.filterLink);h.disableLink&&this.disableLink(b);
var f=b.node.parentNode.insertBefore(f,b.node.nextSibling),g=f.parentNode,t=b.node.getAttribute("forceInline");a=100;if("LI"!=g.tagName&&"true"!=t){if("TD"==g.tagName||"SPAN"==g.tagName)g=g.parentNode;a=g.offsetWidth-b.node.offsetWidth}f.style.cssText=a>2*h.iconWidth?mcafee_wa_constants.annDivDefaultStyle+mcafee_wa_constants.annDivInline:mcafee_wa_constants.annDivDefaultStyle+mcafee_wa_constants.annDivNonInline}catch(p){mcafee_wa_globals.logger.error(p)}};
mcafee_wa_annotationinserter.prototype.highlightLink=function(b,a){b.node.style.backgroundColor=a};
mcafee_wa_annotationinserter.prototype.disableLink=function(b,a){b.node.setAttribute("onmousedown","return false;");b.node.target="_self";mcafee_wa_resourcemanager.getResString("safe.yahooblockMessage",function(a){b.node.setAttribute("title",a)});b.node.style.cssText="color:#808080;text-decoration:underline;cursor:pointer;display:inline-block;text-indent:0;";b.node&&b.node.getElementsByTagName("A")[0]&&(b.node.getElementsByTagName("A")[0].style.color="#808080");a&&a.features&&a.features.highlite&&
(b.node.style.backgroundColor="#F9E2E8")};
mcafee_wa_annotationinserter.prototype.annotatePage=function(b,a,c,d,f){try{this._document=f;(new mcafee_wa_ballooncreator(this._document)).createBalloon(f);this.createStyle();var h=new mcafee_wa_eventhandler(f,a,c);mcafee_wa_globals.logger.log("Annotating a total of "+d.length+" links in page "+this._document.location.href);for(c=0;c<d.length;++c){var k=d[c],g=b[k.url];if("undefined"!=typeof g&&null!=g){mcafee_wa_globals.debugMode&&(g.matchedSelector=k.matchedSelector);var t=mcafee_wa_annotationhelper.getActualScore(g);
if(null!=mcafee_wa_globals.annotationEvents.onAnnotatingLink)mcafee_wa_globals.annotationEvents.onAnnotatingLink(g,a);k.node&&a.features.showIcons&&(!a.features.showOnlyHackersafe||g.hackerSafe)&&(mcafee_wa_annotationhelper.populateLinkInfo(g,k.url,a,t),this.insertAnnotationImage(k,g,a,h));d[c].node=null}}if(null!=mcafee_wa_globals.annotationEvents.onCompleteAnnotation)mcafee_wa_globals.annotationEvents.onCompleteAnnotation(this._document.location.href)}catch(p){return mcafee_wa_globals.logger.error(p),
!1}return!0};function mcafee_wa_annotationengine(b,a){this._document=b;this._engine=a}mcafee_wa_annotationengine.prototype.matchURL=function(b){for(var a=0;a<this._engine.stre.length;++a){var c=b.match(this._engine.stre[a]);if(c)return c}return null};mcafee_wa_annotationengine.prototype.getSearchTerms=function(){var b=this.matchURL(this._document.location.href);if(null!=b&&1<b.length)return decodeURIComponent(b[1].replace(/\+/g," "))};
mcafee_wa_annotationengine.prototype.annotateProc=function(b,a){if(null==b||"undefined"==typeof b)mcafee_wa_globals.logger.error("The json response received from server for DSS Request is null");else{var c=null;if("string"==typeof b){if(0==b.length){mcafee_wa_globals.logger.error("Empty string received as DSS Response");return}c=JSON.parse(b)}else c=b;if(null==c.safeSearchResponse||null==c.safeSearchResponse.annotationMap)mcafee_wa_globals.logger.log("JSON response is not having expected nodes it the JSON");
else{mcafee_wa_globals.logger.log(" JSON response received is good. Now going to add annotations for the links");var d=c.safeSearchResponse.config,c=c.safeSearchResponse.annotationMap;(new mcafee_wa_annotationinserter).annotatePage(c,d,this._engine,a,this._document)}}};
mcafee_wa_annotationengine.prototype.processPage=function(){var b=this;if(null!=mcafee_wa_globals.annotationEvents.onBeginAnnotation){var a=this.getSearchTerms();mcafee_wa_globals.annotationEvents.onBeginAnnotation(this._document.location.href,this._engine.name,a)}mcafee_wa_globals.logger.log("About to start harvesting links from the page "+this._document.location.href);mcafee_wa_linkharvester.harvestLinks(this._document,this._engine,function(a,d){0<a.length&&(mcafee_wa_globals.logger.log(a.length+
" URLs are harvested from "+b._document.location.href+". Going to make DSS Request"),mcafee_wa_globals.dssRequestor.post(escape(b._document.location.href),b._engine.sourcetype,a,function(a){mcafee_wa_timer.set(b._document,function(){mcafee_wa_globals.logger.log(" DSS Response received for page"+b._document.location.href);b.annotateProc(a,d)},0)}))})};mcafee_wa_annotationengine.prototype.processUrl=function(){var b=this;mcafee_wa_timer.set(this._document,function(){b.processPage()},0)};
mcafee_wa_annotationengine.prototype.stop=function(){};
var mcafee_wa_coreengine=function(){return{init:function(b,a){null!=b.logger&&"undefined"!=typeof b.logger?mcafee_wa_globals.logger=b.logger:(mcafee_wa_globals.logger=new mcafee_wa_logger,"undefined"!=typeof b.logType&&mcafee_wa_globals.logger.SetLogTypes(b.logType));if(null==b.dssRequestor)return mcafee_wa_globals.logger.error("DSS requestor has to be valid for coreengine to initialize"),!1;mcafee_wa_globals.logger.log("Initializing core engine");mcafee_wa_globals.resourceRequestor=b.resourceRequestor;
mcafee_wa_globals.dssRequestor=b.dssRequestor;mcafee_wa_globals.resourceRootURI=b.resourceRootURI;mcafee_wa_globals.resourceRequestor=b.resourceRequestor?b.resourceRequestor:new mcafee_wa_resourcerequestor;mcafee_wa_globals.reputationReqCount=b.reputationReqCount;mcafee_wa_globals.balloonProperties=b.balloonProperties?b.balloonProperties:mcafee_wa_balloonproperties;mcafee_wa_globals.annotationProperties=b.annotationProperties?b.annotationProperties:mcafee_wa_annotationproperties;mcafee_wa_globals.annotationEvents=
b.events;mcafee_wa_globals.debugMode=b.debugMode;mcafee_wa_searchengine.init(a);return!0},annotate:function(b){try{var a;for(var c="(",d=mcafee_wa_searchengine.getEngines(),f=0;f<d.length;++f)c+=d[f].name,c+="|";c=c.substr(0,c.length-1)+")";mcafee_wa_globals.logger.log("Supported search engines: "+c);b&&b.location&&b.location.href&&b.location.href.match("http(s)?://([a-z0-9-.]+.)?"+c)?a=!0:(mcafee_wa_globals.logger.log("The url "+b.location.href+" does not match with any of the supported search engines"),
a=!1);if(!a)return!1;var h=mcafee_wa_searchengine.getEngineForUrl(b.location.href);if(null==h)return mcafee_wa_globals.logger.error("Failed to get engine for url "+b.location.href),!1;mcafee_wa_globals.activeURI!=b.location.href&&(mcafee_wa_globals.mapSelectors.clear(),mcafee_wa_globals.activeURI=b.location.href);(new mcafee_wa_annotationengine(b,h)).processUrl()}catch(k){return mcafee_wa_globals.logger.error(k),!1}return!0},shutdown:function(){},getEngines:function(){return mcafee_wa_searchengine.getEngines()},
getAnnotationProperties:function(){return mcafee_wa_globals.annotationProperties.properties},getBalloonProperties:function(){return mcafee_wa_globals.balloonProperties.properties}}}();
