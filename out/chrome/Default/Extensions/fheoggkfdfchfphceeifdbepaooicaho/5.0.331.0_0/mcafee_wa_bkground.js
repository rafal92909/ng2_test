/*******************  INTEL CONFIDENTIAL AND PROPRIETARY  **************************
*
*  Copyright (c) 2016 Intel Corporation.  All Rights Reserved.
*
*  This file and the information contained herein is the confidential and
*  proprietary information of Intel Corporation.  Your rights to this file and its
*  information are subject to the terms of the license agreement between
*  Intel Corporation and you or your company.
*
********************  INTEL CONFIDENTIAL AND PROPRIETARY  **************************/

var mcafee_wa_bkconstants={uninstallUrl:"https://home.mcafee.com/root/landingpage.aspx?lpname=get-it-now",blockPageUrl:"http://www.siteadvisor.com/restricted.html?domain=",blockPageUrlSecure:"https://www.siteadvisor.com/restricted.html?domain=",siteReportUrl:"https://www.mcafee.com/threat-intelligence/site/default.aspx?url=",typoSquattingUrl:"http://www.siteadvisor.com/typosquatting.html",typoSquattingUrlSecure:"https://www.siteadvisor.com/typosquatting.html",maxCacheRecords:1E3,browsertype:"browsertype",
useragent:"useragent",whitelistUrl:"about:blank?command=whitelist&token=1&whitelisturl=",domain:"domain",redirectURL:"redirectURL",originalURL:"originalURL",disabled:"disabled"};mcafee_wa_browsertypes={Unknown:-1,Firefox:1,Chrome:2,McAfeeSecureBrowser:3,Opera:4,Edge:5,Agnostic:6};function mcafee_wa_cache(){}mcafee_wa_cache.prototype.set=function(a,b){};mcafee_wa_cache.prototype.get=function(a){};mcafee_wa_color={SA_Green:0,SA_Yellow:1,SA_Red:2,SA_Unknown:3,SA_HackerSafe:4,SA_Cashback:5,SA_Disabled:6};
var mcafee_wa_commands={dssrequest:"dssrequest",reportstat:"reportstat",executecommand:"executecommand",ondoccomplete:"ondoccomplete",onnavigateiframe:"onnavigateiframe",onredirectiframe:"onredirectiframe",onnavigate:"onnavigate",onoptionreceived:"onoptionreceived",setoption:"setoption",isdisabled:"isdisabled",isframeblocked:"isframeblocked"},mcafee_wa_disabledflags={disabledChrome:1,disabledSafeBrowser:2,disabledFirefox:4,disabledEdge:8,disabledOpera:16},mcafee_wa_globals=function(){var a=Date.now(),
b=new Map;return{uid:a,resourceRequestor:null,dssRequestor:null,resourceRootURI:null,annotationProperties:null,balloonProperties:null,reputationReqCount:10,annotationEvents:null,activeBalloonElement:null,debugMode:!1,logger:null,activeURI:null,mapSelectors:b}}(),mcafee_wa_jscommands={addbitmap:"addBitmap",addcontexttomap:"addContextToMap",addctxref:"addCtxRef",addurlhash:"addUrlHash",changebitmap:"changeBitmap",geturlhash:"getUrlHash",idfromcontext:"idFromContext",navigate:"navigate",removectxref:"removeCtxRef",
tryaddpasswordhandler:"tryAddPasswordHandler",urlfromcontext:"urlFromContext"};mcafee_wa_logtypes={None:0,Info:1,Warn:2,Err:4,Profile:8,Log:16,All:31};
var mcafee_wa_nativecommands={activate:"activate",ondownloadfinished:"onDownloadFinished",reportstat:"reportStat",ondssrequest:"onDssRequest",onbeforenavigate:"onBeforeNavigate",onnavigate:"onNavigate",ondoccomplete:"onDocComplete",executecommand:"executeCommand",onMenuItemClick:"onMenuItemClick",reporttelemetry:"reportTelemetry",setsystemoptionstring:"setSystemOptionString",getsystemoptionstring:"getSystemOptionString",getsystemoptionbool:"getSystemOptionBool",onCSync:"onCSync"};
function mcafee_wa_onbeforesendheaderlistener(){}mcafee_wa_onbeforesendheaderlistener.prototype.init=function(){};function mcafee_wa_promise(){this.pThis=this.commandParams=this.command=this.promise=this.reject=this.resolve=null}mcafee_wa_promise.prototype.createPromise=function(a,b,c,d,e,f){this.resolve=b;this.reject=c;this.command=d;this.commandParams=e;this.pThis=f;return this.promise=new Promise(a)};mcafee_wa_scorevals={ScoreMinimal:15,ScoreUnknown:30,ScoreMedium:50};
var mcafee_wa_searchoption={securesearch:1,anysearch:2,nosearch:0},mcafee_wa_telemetrycounters={incrstatsrchitunk:"INCREMENTSTAT_SearchHit_Unknown_",incrstat:"INCREMENTSTAT_",balloondisplay:"BALLOONDISPLAY_",browsererr:"BrowserError"},mcafee_wa_uriparser=function(){return{getParam:function(a,b){var c=a.split("?");if(2!=c.length)return null;for(var c=c[1].split("&"),d=0;d<c.length;++d){var e=c[d].split("=");if(2==e.length&&e[0]==b)return e[1]}return null}}}(),mcafee_wa_blockpageuri=function(){return{getBlockPageURI:function(a,
b,c){chrome.management.getSelf(function(d){var e=chrome.i18n.getUILanguage();d=mcafee_wa_bkconstants.blockPageUrl+a+"&client_ver="+d.version+"&locale="+e;b&&(d+="&subframe=1");c(d)});return!0}}}(),mcafee_wa_browsertypefinder=function(){return{getBrowserType:function(a){return a==mcafee_wa_browsertypes.Chrome&&/Secure\//.test(navigator.userAgent)?mcafee_wa_browsertypes.McAfeeSecureBrowser:a}}}();function mcafee_wa_logger(){this._logTypes=mcafee_wa_logtypes.None}
mcafee_wa_logger.prototype.SetLogTypes=function(a){this._logTypes=a};mcafee_wa_logger.prototype.log=function(a){mcafee_wa_logtypes.Log&this._logTypes&&console.log((new Date).toLocaleString()+" "+a)};mcafee_wa_logger.prototype.error=function(a){mcafee_wa_logtypes.Err&this._logTypes&&console.error((new Date).toLocaleString()+" "+a)};function mcafee_wa_resourcerequestor(){this._messages=null}
mcafee_wa_resourcerequestor.prototype.getURI=function(a){return null!=mcafee_wa_globals.resourceRootURI?mcafee_wa_globals.resourceRootURI+a:chrome.extension.getURL(a)};
mcafee_wa_resourcerequestor.prototype.getImage=function(a,b){try{var c=new XMLHttpRequest,d=this.getURI("images/"+a);c.open("GET",d,!0);c.responseType="blob";c.onload=function(a){if(4==c.readyState&&200==c.status){var d=new FileReader;d.onloadend=function(){b(d.result)};d.readAsDataURL(c.response)}};c.onerror=function(b){mcafee_wa_globals.logger.error("Failed in requesting html: "+a+b)};c.send(null)}catch(e){mcafee_wa_globals.logger.error(e)}};
mcafee_wa_resourcerequestor.prototype.getContent=function(a,b,c){try{var d=new XMLHttpRequest,e=this.getURI(b+a);d.open("GET",e,!0);d.onload=function(a){4==d.readyState&&200==d.status&&c(d.responseText)};d.onerror=function(b){mcafee_wa_globals.logger.error("Failed in requesting :"+a+b)};d.send(null)}catch(f){mcafee_wa_globals.logger.error(f)}};mcafee_wa_resourcerequestor.prototype.getJSON=function(a,b){this.getContent(a,"json/",b)};
mcafee_wa_resourcerequestor.prototype.getHtml=function(a,b){this.getContent(a,"html/",b)};mcafee_wa_resourcerequestor.prototype.getResStr=function(a,b){if(null!=mcafee_wa_globals.resourceRootURI){var c=this;null==this._messages?this.getContent("messages.json","_locales/"+window.navigator.language,function(d){null!=d&&(c._messages=JSON.parse(d),null!=c._messages&&b(c._messages[a].message))}):b(c._messages[a].message)}else{var d=chrome.i18n.getMessage(a);"??"==d&&(d="");b(d)}};
var mcafee_wa_bkglobals=function(){var a=new mcafee_wa_logger,b=new mcafee_wa_cache,c=new Map,d=new Map;return{messageDispatcher:null,activetabId:-1,debugMode:!1,logger:a,browserType:0,cache:b,testMode:!1,tabIdURIMap:c,options:d}}(),mcafee_wa_bkcommon=function(){return{toColor:function(a){return a<mcafee_wa_scorevals.ScoreMinimal?mcafee_wa_color.SA_Green:a<mcafee_wa_scorevals.ScoreUnknown?mcafee_wa_color.SA_Unknown:a<mcafee_wa_scorevals.ScoreMedium?mcafee_wa_color.SA_Yellow:mcafee_wa_color.SA_Red},
isDisabled:function(a,b){for(var c=[{browser:mcafee_wa_browsertypes.Chrome,flag:mcafee_wa_disabledflags.disabledChrome},{browser:mcafee_wa_browsertypes.McAfeeSecureBrowser,flag:mcafee_wa_disabledflags.disabledSafeBrowser},{browser:mcafee_wa_browsertypes.Firefox,flag:mcafee_wa_disabledflags.disabledFirefox},{browser:mcafee_wa_browsertypes.Edge,flag:mcafee_wa_disabledflags.disabledEdge},{browser:mcafee_wa_browsertypes.Opera,flag:mcafee_wa_disabledflags.disabledOpera}],d=0;d<c.length;++d)if(c[d].browser==
b)return 0!=c[d].flag&a?!0:!1;return!1}}}();function mcafee_wa_onchangeddownloadslistener(){}mcafee_wa_onchangeddownloadslistener.prototype.init=function(){mcafee_wa_bkglobals.logger.log("adding download listener");try{chrome.downloads.onChanged.addListener(function(a){try{mcafee_wa_bkglobals.logger.log("download event received"),null!=a&&null!=a.state&&"complete"==a.state.current&&(mcafee_wa_bkglobals.logger.log("download completed"),chrome.downloads.search({id:a.id},function(a){a.forEach(function(a){mcafee_wa_bkglobals.messageDispatcher.onDownloadFinished(a)})}))}catch(b){mcafee_wa_bkglobals.logger.error(b)}})}catch(a){mcafee_wa_bkglobals.logger.error(a)}};
function mcafee_wa_ontabupdatedlistener(){}mcafee_wa_ontabupdatedlistener.prototype.init=function(){chrome.tabs.onUpdated.addListener(function(a,b,c){"undefined"!=typeof b.url&&null!=b.url&&(b.url.startsWith("http")||b.url.startsWith("www.")||0==b.frameId&&mcafee_wa_bkglobals.messageDispatcher.setBrowserActionForNonURI())})};function mcafee_wa_tablistener(){}
mcafee_wa_tablistener.prototype.init=function(){chrome.tabs.onActivated.addListener(function(a){mcafee_wa_bkglobals.activetabId=a.tabId;mcafee_wa_bkglobals.options[mcafee_wa_bkconstants.disabled]&&mcafee_wa_browsertypes.McAfeeSecureBrowser==mcafee_wa_bkglobals.browserType?chrome.browserAction.disable(a.tabId):chrome.tabs.get(a.tabId,function(b){b.url.startsWith("http")||b.url.startsWith("www.")?mcafee_wa_bkglobals.messageDispatcher.activateTab(a.tabId,b.url):mcafee_wa_bkglobals.messageDispatcher.setBrowserActionForNonURI()})});
chrome.tabs.onCreated.addListener(function(a){mcafee_wa_bkglobals.options[mcafee_wa_bkconstants.disabled]&&mcafee_wa_browsertypes.McAfeeSecureBrowser==mcafee_wa_bkglobals.browserType&&chrome.browserAction.disable(a.tabId)})};function mcafee_wa_webrequestlistener(){}
mcafee_wa_webrequestlistener.prototype.init=function(){chrome.webRequest.onHeadersReceived.addListener(function(a){if(399<a.statusCode&&600>a.statusCode){var b=mcafee_wa_bkglobals.tabIdURIMap[a.tabId];null!=b&&"string"==typeof b&&a.url==b&&mcafee_wa_bkglobals.messageDispatcher.reportTelemetry({Name:mcafee_wa_telemetrycounters.browsererr,statusCode:a.statusCode})}},{urls:["http://*/*","https://*/*"],types:["main_frame"]});chrome.webRequest.onBeforeRequest.addListener(function(a){0==a.frameId&&(mcafee_wa_bkglobals.tabIdURIMap[a.tabId]=
a.url);mcafee_wa_bkglobals.messageDispatcher.onBeforeNavigate(a.url,a.tabId,a.frameId)},{urls:["http://*/*","https://*/*"],types:["main_frame","sub_frame"]});chrome.webRequest.onCompleted.addListener(function(a){mcafee_wa_bkglobals.messageDispatcher.onNavigate(a.url,a.tabId,a.frameId);mcafee_wa_bkglobals.messageDispatcher.onDocComplete(a.url)},{urls:["http://*/*","https://*/*"],types:["main_frame","sub_frame"]})};
function mcafee_wa_legacynativemsgdispatcher(){this._port=0;this._callbackId=100;this._messageMap={0:{}};this._contextMap={0:[null,-1]};this._icons=[];this._blockedFrames=new Map;this._urlToIcon=new Map}mcafee_wa_legacynativemsgdispatcher.prototype.nativeMsg=function(a){try{var b=[1,0].concat(a);this.postMessage(b)}catch(c){return mcafee_wa_bkglobals.logger.error(c),!1}return!0};
mcafee_wa_legacynativemsgdispatcher.prototype.postMessage=function(a){for(var b=0;2>b;++b)if(null==this._port&&this.init(),null!=this._port)try{this._port.postMessage(a);break}catch(c){this._port.disconnect(),this._port=null,mcafee_wa_bkglobals.logger.error(c)}};mcafee_wa_legacynativemsgdispatcher.prototype.addNewContext=function(a,b,c,d){this._contextMap[a]={req:b,url:c,topmost:d,refcount:1};return a};
mcafee_wa_legacynativemsgdispatcher.prototype.urlFromContext=function(a){a=this._contextMap[a];if(null!=a&&"undefined"!=typeof a)return a.url};mcafee_wa_legacynativemsgdispatcher.prototype.toTabId=function(a){a=parseInt(a);return isNaN(a)?-1:a<<16>>16};mcafee_wa_legacynativemsgdispatcher.prototype.toFrameId=function(a){var b=parseInt(a);return isNaN(b)?-1:a>>16};
mcafee_wa_legacynativemsgdispatcher.prototype.isBlockPageURI=function(a){return a.startsWith(mcafee_wa_bkconstants.blockPageUrl)||a.startsWith(mcafee_wa_bkconstants.typoSquattingUrl)||a.startsWith(mcafee_wa_bkconstants.blockPageUrlSecure)||a.startsWith(mcafee_wa_bkconstants.typoSquattingUrlSecure)?!0:!1};
mcafee_wa_legacynativemsgdispatcher.prototype.navigateTab=function(a,b){var c=this.toFrameId(a),d=this.toTabId(a);mcafee_wa_bkglobals.logger.log("Navigate event received from native app for (tabid, frameId, uri) ,"+d+","+c+","+b);if(0==c)if(this.isBlockPageURI(b))c={},c.url=b,chrome.tabs.update(d,c);else{var e=this;chrome.tabs.get(d,function(a){e.isBlockPageURI(a.url)?(a={},a.url=b,chrome.tabs.update(d,a)):chrome.tabs.reload(d)})}else{var f={};f.command=mcafee_wa_commands.onredirectiframe;f.uri=b;
var g=mcafee_wa_uriparser.getParam(b,"domain"),g=unescape(g);this._blockedFrames[g]=b;mcafee_wa_bkglobals.logger.log("Send Message to frame: "+c+" uri: "+b);chrome.tabs.sendMessage(d,f,function(a){"undefined"==typeof a&&mcafee_wa_bkglobals.logger.error(chrome.runtime.lastError)})}};
mcafee_wa_legacynativemsgdispatcher.prototype.isFrameBlocked=function(a){var b=this._blockedFrames[a];mcafee_wa_bkglobals.logger.log("Checking whether iFrame is blocked for: "+a+". Status is : "+b);return{blocked:"undefined"!=typeof b,uri:b}};mcafee_wa_legacynativemsgdispatcher.prototype.toQualifiedImagePath=function(a){a="images/small_"+a;return(new mcafee_wa_resourcerequestor).getURI(a)};mcafee_wa_legacynativemsgdispatcher.prototype.toPageImage=function(a){return a>=this._icons.length?null:this.toQualifiedImagePath(this._icons[a])};
mcafee_wa_legacynativemsgdispatcher.prototype.setBrowserActionForNonURI=function(){var a=this.toQualifiedImagePath("button_disabled.gif");this.setBrowserActionFromIcon(a)};mcafee_wa_legacynativemsgdispatcher.prototype.setBrowserActionFromIcon=function(a){chrome.browserAction.setIcon({path:a});1==mcafee_wa_bkglobals.debugMode&&(mcafee_wa_bkglobals.logger.log("Changebitmap: ("+a+")"),chrome.browserAction.setTitle({title:a}))};
mcafee_wa_legacynativemsgdispatcher.prototype.setBrowserActionIcon=function(a,b){var c=this.toPageImage(a);null!=c&&(this.setBrowserActionFromIcon(c),this._urlToIcon[b]=a)};
mcafee_wa_legacynativemsgdispatcher.prototype.changeBrowserAction=function(a,b){try{var c=this.toTabId(a);if(-1!=c){var d=this;chrome.tabs.get(c,function(c){chrome.runtime.lastError&&mcafee_wa_bkglobals.logger.error(chrome.runtime.lastError.message);if("undefined"!=typeof c&&null!=c&&c.active){var f=d._contextMap[a];"undefined"!=typeof f&&f.url==c.url&&d.setBrowserActionIcon(b,c.url)}})}}catch(e){mcafee_wa_bkglobals.logger.error(e)}};
mcafee_wa_legacynativemsgdispatcher.prototype.activateTab=function(a,b){var c=this._urlToIcon[b];null!=c&&"undefined"!=typeof c&&this.setBrowserActionIcon(c,b)};mcafee_wa_legacynativemsgdispatcher.prototype.processOption=function(a,b){mcafee_wa_bkglobals.options[a]=b;chrome.tabs.query({},function(c){for(var d={command:mcafee_wa_commands.onoptionreceived,optionName:a,optionValue:b},e=0;e<c.length;e++)chrome.tabs.sendMessage(c[e].id,d,null)})};
mcafee_wa_legacynativemsgdispatcher.prototype.processInwardMssage=function(a){if(3>a.length)return[];mcafee_wa_bkglobals.logger.log("Processing inward message: "+a[2]);switch(a[2]){case mcafee_wa_jscommands.addbitmap:return this._icons.push(a[3]),this._icons.length-1;case mcafee_wa_jscommands.changebitmap:this.changeBrowserAction(a[5],a[3]);break;case mcafee_wa_jscommands.navigate:this.navigateTab(a[5],a[3]);break;case mcafee_wa_jscommands.urlfromcontext:return this.urlFromContext(a[3])}};
mcafee_wa_legacynativemsgdispatcher.prototype.listen=function(){var a=this;this._port.onMessage.addListener(function(b){if(!(2>b.length)){var c=parseInt(b[0],10);if(0!=c){var d=a._messageMap[c];null!=d&&"undefined"!=typeof d&&(d.waPromise.resolve({response:b,callback:d.callback,promise:d.waPromise}),delete a._messageMap[c])}else c=a.processInwardMssage(b),a.postMessage([0,b[1],c])}})};
mcafee_wa_legacynativemsgdispatcher.prototype.setSystemOptionString=function(a,b){this.nativeMsg([mcafee_wa_nativecommands.setsystemoptionstring,a,b])};mcafee_wa_legacynativemsgdispatcher.prototype.getSystemOptionString=function(a,b,c){return this.makePromise(mcafee_wa_nativecommands.getsystemoptionstring,"undefined"==typeof c?null:c,[a,b])};
mcafee_wa_legacynativemsgdispatcher.prototype.getSystemOptionBool=function(a,b,c){return this.makePromise(mcafee_wa_nativecommands.getsystemoptionbool,"undefined"==typeof c?null:c,[a,b])};
mcafee_wa_legacynativemsgdispatcher.prototype.init=function(a){try{if(this._port=chrome.runtime.connectNative("siteadvisor.mcafee.chrome.extension"),null!=this._port)return this.listen(),this.setSystemOptionString(mcafee_wa_bkconstants.browsertype,mcafee_wa_bkglobals.browserType.toString()),this.setSystemOptionString(mcafee_wa_bkconstants.useragent,navigator.userAgent),this.nativeMsg([mcafee_wa_nativecommands.activate]),this.getSystemOptionString(mcafee_wa_bkconstants.disabled,"0",a),!0}catch(b){return mcafee_wa_bkglobals.logger.error(b),
!1}return null!=this._port};mcafee_wa_legacynativemsgdispatcher.prototype.uninit=function(){null!=this._port&&(this._port.disconnect(),this._port=null)};
mcafee_wa_legacynativemsgdispatcher.prototype.then=function(a){try{switch(a.promise.command){case mcafee_wa_nativecommands.getsystemoptionbool:var b=null==a.response[1]||a.response[1];a.promise.pThis.processOption(a.promise.commandParams[0],b);null!=a.callback&&a.callback(b);break;case mcafee_wa_nativecommands.getsystemoptionstring:a.promise.pThis.processOption(a.promise.commandParams[0],a.response[1]);null!=a.callback&&a.callback(a.response[1]);break;case mcafee_wa_nativecommands.ondssrequest:var c=
JSON.parse(a.response[1]);a.callback(c)}}catch(d){mcafee_wa_bkglobals.logger.error(d)}};mcafee_wa_legacynativemsgdispatcher.prototype.makePromise=function(a,b,c){var d=this,e=++this._callbackId,f=new mcafee_wa_promise,g=f.createPromise(function(b,f){var g=[1,e,a].concat(c);d.postMessage(g)},this.then,null,a,c,d);this._messageMap[e]={waPromise:f,callback:b};g.then(this.then);return!0};
mcafee_wa_legacynativemsgdispatcher.prototype.makeDSSRequest=function(a,b,c,d){a="dssrequest:multiquery/MultiQuery?tojson=1&href="+a+"&sourceType="+b;c=c.join("\t");return this.makePromise(mcafee_wa_nativecommands.ondssrequest,d,[a,c])};mcafee_wa_legacynativemsgdispatcher.prototype.onDownloadFinished=function(a){this.nativeMsg([mcafee_wa_nativecommands.ondownloadfinished,a.url,a.filename,a.referrer]);return!1};
mcafee_wa_legacynativemsgdispatcher.prototype.reportTelemetry=function(a){mcafee_wa_bkglobals.logger.log("Stat: "+a.Name+" Value: "+a.statusCode);this.nativeMsg([mcafee_wa_nativecommands.reporttelemetry,a.Name,a.statusCode.toString(),"",mcafee_wa_bkglobals.browserType.toString()])};
mcafee_wa_legacynativemsgdispatcher.prototype.reportStat=function(a){mcafee_wa_bkglobals.logger.log("Stat: "+a.Name+" Value: "+a.Value);this.nativeMsg([mcafee_wa_nativecommands.reportstat,a.Name,"string"==typeof a.Value?a.Value:a.Value.toString()]);return!1};mcafee_wa_legacynativemsgdispatcher.prototype.onSettings=function(a){var b=this.generateContextId(mcafee_wa_bkglobals.activetabId,0);this.addNewContext(b,b,a,!0);this.nativeMsg([mcafee_wa_nativecommands.onMenuItemClick,114,b.toString()]);return!1};
mcafee_wa_legacynativemsgdispatcher.prototype.onDocComplete=function(a){this.nativeMsg([mcafee_wa_nativecommands.ondoccomplete,a,"",0,!0]);return!1};mcafee_wa_legacynativemsgdispatcher.prototype.generateContextId=function(a,b){return-1==b?a:a|b<<16};
mcafee_wa_legacynativemsgdispatcher.prototype.onBeforeNavigate=function(a,b,c){0>=c&&(delete this._blockedFrames,this._blockedFrames=new Map);var d=this.generateContextId(b,c);this.addNewContext(d,d,a,!0);mcafee_wa_bkglobals.logger.log("onBeforeNavigate event called for ( uri, tabId, frameid, contextid) ("+a+","+b+","+c+","+d+")");this.nativeMsg([mcafee_wa_nativecommands.onbeforenavigate,a,d.toString(),d.toString(),!0]);return!1};
mcafee_wa_legacynativemsgdispatcher.prototype.onNavigate=function(a,b,c){var d=this.generateContextId(b,c);this.addNewContext(d,d,a,!0);mcafee_wa_bkglobals.logger.log("onNavigate event called for ( uri, tabId, frameid, contextid) ("+a+","+b+","+c+","+d+")");this.nativeMsg([mcafee_wa_nativecommands.onnavigate,a,d.toString(),d.toString(),!0]);return!1};mcafee_wa_legacynativemsgdispatcher.prototype.executeCommand=function(a,b){this.nativeMsg([mcafee_wa_nativecommands.executecommand,a,b])};
mcafee_wa_legacynativemsgdispatcher.prototype.onCSync=function(a,b){this.nativeMsg([mcafee_wa_nativecommands.onCSync,navigator.userAgent,a,b])};function mcafee_wa_onmessagelistener(){}
mcafee_wa_onmessagelistener.prototype.init=function(){try{chrome.runtime.onMessage.addListener(function(a,b,c){var d=!1;try{switch(a.command){case mcafee_wa_commands.dssrequest:d=mcafee_wa_bkglobals.messageDispatcher.makeDSSRequest(a.Url,a.searchEngineType,a.requestData,c);break;case mcafee_wa_commands.reportstat:d=mcafee_wa_bkglobals.messageDispatcher.reportStat(a);break;case mcafee_wa_commands.executecommand:d=mcafee_wa_bkglobals.messageDispatcher.executeCommand(a.commandId,a.params);break;case mcafee_wa_commands.onnavigate:d=
mcafee_wa_bkglobals.messageDispatcher.onBeforeNavigate(a.Url,b.tab.id,0);d=mcafee_wa_bkglobals.messageDispatcher.onNavigate(a.Url,b.tab.id,0);break;case mcafee_wa_commands.isdisabled:var e=parseInt(mcafee_wa_bkglobals.options[mcafee_wa_bkconstants.disabled]),f=mcafee_wa_bkcommon.isDisabled(e,mcafee_wa_bkglobals.browserType);c(f);break;case mcafee_wa_commands.isframeblocked:var g=mcafee_wa_bkglobals.messageDispatcher.isFrameBlocked(a.Url);c(g)}}catch(h){mcafee_wa_bkglobals.logger.error(h)}return d})}catch(a){mcafee_wa_bkglobals.logger.error(a)}};
var mcafee_wa_listenermanager=function(){var a=[];return{getListeners:function(){0==a.length&&(a.push(new mcafee_wa_onmessagelistener),a.push(new mcafee_wa_tablistener),a.push(new mcafee_wa_ontabupdatedlistener),a.push(new mcafee_wa_webrequestlistener),mcafee_wa_bkglobals.browserType!=mcafee_wa_browsertypes.Edge&&a.push(new mcafee_wa_onchangeddownloadslistener),a.push(new mcafee_wa_onbeforesendheaderlistener));return a},getListenersWhenDisabled:function(){0==a.length&&(a.push(new mcafee_wa_tablistener),
a.push(new mcafee_wa_onmessagelistener));return a}}}();function mcafee_wa_background(){}mcafee_wa_background.prototype.initMsgDispatcher=function(a){var b=null,b=1==mcafee_wa_bkglobals.onlineMode||mcafee_wa_browsertypes.Edge==mcafee_wa_bkglobals.browserType||1==mcafee_wa_bkglobals.testMode?new mcafee_wa_msgdispatcher:new mcafee_wa_legacynativemsgdispatcher;mcafee_wa_bkglobals.messageDispatcher=b;return b.init(a)?!0:!1};
mcafee_wa_background.prototype.processActiveTab=function(){chrome.tabs.query({active:!0},function(a){0!=a.length&&(mcafee_wa_bkglobals.activetabId=a[0].id,mcafee_wa_bkglobals.messageDispatcher.onBeforeNavigate(a[0].url,a[0].id,-1),mcafee_wa_bkglobals.messageDispatcher.onNavigate(a[0].url,a[0].id,-1))})};
mcafee_wa_background.prototype.handleDisabled=function(){mcafee_wa_bkglobals.messageDispatcher.uninit();for(var a=mcafee_wa_listenermanager.getListenersWhenDisabled(),b=0;b<a.length;++b)a[b].init();chrome.tabs.query({active:!0},function(a){0!=a.length&&chrome.browserAction.disable(a[0].tabId)})};mcafee_wa_background.prototype.handleEnabled=function(){for(var a=mcafee_wa_listenermanager.getListeners(),b=0;b<a.length;++b)a[b].init();this.processActiveTab()};
mcafee_wa_background.prototype.main=function(){mcafee_wa_bkglobals.logger.SetLogTypes(mcafee_wa_logtypes.None);mcafee_wa_bkglobals.debugMode=!1;mcafee_wa_bkglobals.testMode=!1;mcafee_wa_bkglobals.onlineMode=!1;mcafee_wa_bkglobals.options[mcafee_wa_bkconstants.disabled]="0";mcafee_wa_bkglobals.browserType=mcafee_wa_browsertypefinder.getBrowserType(mcafee_wa_browsertypes.Chrome);var a=this;this.initMsgDispatcher(function(b){b=parseInt(b);mcafee_wa_bkcommon.isDisabled(b,mcafee_wa_bkglobals.browserType)?
a.handleDisabled():a.handleEnabled()})};var bkobj=new mcafee_wa_background;bkobj.main();
